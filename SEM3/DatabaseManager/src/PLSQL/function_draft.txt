-- PL/SQL function for calculating price on a ticket on the database
-- Run it in PuTTY (no PL/SQL support in NetBeans)
-- $1 : old price
-- $2 : entered new zone
create or replace function calcPrice(int, boolean) returns int as $$
declare 
    oldPrice alias for $1;
    enteredNewZone alias for $2;
    zonePrice int = 1200;   -- Zone price in danish Ã¸re
    newPrice int;           -- return value
begin
    -- New ticket, default 2 zones.
    if oldPrice = 0 then    
        newPrice := zonePrice * 2;

    -- Ticket counts for all zones (9 zones)
    elsif oldPrice = (9 * zonePrice) then
        newPrice := oldPrice;

    -- Has ticket and still in same zone; no changes in price
    elsif enteredNewZone is false then
        newPrice := oldPrice;

    -- Has ticket but new zone; add another zone
    else
        newPrice := oldPrice + zonePrice;
    end if;

    return newPrice;
end
$$ language plpgsql;
